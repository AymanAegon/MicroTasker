(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{2543:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3359:(e,s,t)=>{Promise.resolve().then(t.bind(t,6044))},6044:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(5155),l=t(285),n=t(6695),r=t(2115),i=t(4092),d=t(5317),c=t(2543),o=t(157);let u=(0,o.A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),h=(0,o.A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var x=t(6874),g=t.n(x),m=t(2523),j=t(5057),p=t(8539),v=t(9409),f=t(5695),y=t(4165);let w=e=>{let{task:s}=e,{firestorePromises:t}=(0,i.useAuth)(),[o,x]=(0,r.useState)(0),{user:w}=(0,i.useAuth)(),b=(0,f.useRouter)(),N=null==w?void 0:w.uid,[k,C]=(0,r.useState)(""),[S,I]=(0,r.useState)(!1),[q,D]=(0,r.useState)(null),[A,T]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{if(!s.id||!(null==w?void 0:w.uid)||!s.userId)return;let{getFirestore:e}=await t,a=e(),l=(0,d.doc)(a,"requests",s.id+(null==w?void 0:w.uid)+s.userId),n=await (0,d.getDoc)(l),r=n.data();n.exists()&&(I(!0),D(r),(null==r?void 0:r.status)==="pending"?T("bg-gray-200 text-gray-500 hover:bg-gray-300"):(null==r?void 0:r.status)==="accepted"?T("bg-green-500 text-white hover:bg-green-600"):(null==r?void 0:r.status)==="canceled"?T("bg-gray-200 text-gray-500 hover:bg-gray-300"):(null==r?void 0:r.status)==="rejected"&&T("bg-red-500 text-white hover:bg-red-600"))})()},[s.id,t,o]);let $=async()=>{if(!w){b.push("/login");return}let{getFirestore:e}=await t,a=e();try{q?await (0,d.updateDoc)((0,d.doc)(a,"requests",s.id+(null==w?void 0:w.uid)+s.userId),{message:k,dateSend:new Date().toString(),status:"pending"}):await (0,d.BN)((0,d.doc)(a,"requests",s.id+(null==w?void 0:w.uid)+s.userId),{message:k,taskId:s.id,senderId:w.uid,reciverId:s.userId,dateSend:new Date().toString(),dateRespond:"",status:"pending"}),C(""),x(o+1)}catch(e){console.error(e)}},_=async()=>{if(!w){b.push("/login");return}let{getFirestore:e}=await t,a=e();try{q?await (0,d.updateDoc)((0,d.doc)(a,"requests",s.id+(null==w?void 0:w.uid)+s.userId),{status:"canceled"}):await (0,d.BN)((0,d.doc)(a,"requests",s.id+(null==w?void 0:w.uid)+s.userId),{message:k,taskId:s.id,senderId:w.uid,reciverId:s.userId,dateSend:new Date().toString(),dateRespond:"",status:"canceled"}),C(""),x(o+1)}catch(e){console.error(e)}},z=s.userId===N,[F,R]=(0,r.useState)(!1),[E,M]=(0,r.useState)(s),B=async()=>{try{if(console.log("Saving task:",E),!E.id)return;let{getFirestore:e}=await t,s=e(),a=(0,d.doc)(s,"tasks",E.id),{id:l,...n}=E;await (0,d.updateDoc)(a,{title:n.title,description:n.description,location:n.location,budget:n.budget,category:n.category}),console.log("Task updated successfully!"),window.location.reload(),x(o+1)}catch(e){console.log("Error updating task.")}},J=async()=>{if(s.userId!==N&&N){alert("You are not authorized to delete this task.");return}try{let{getFirestore:e}=await t,a=e();await (0,d.kd)((0,d.doc)(a,"tasks",s.id)),b.push("/")}catch(e){console.error("Error deleting task:",e)}},L=e=>{let{name:s,value:t}=e.target;M(e=>({...e,[s]:t}))};return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"flex flex-col justify-center items-center py-10 bg-secondary gap-4 w-full min-h-screen",children:(0,a.jsxs)("div",{className:"w-full max-w-2xl px-4",children:[(0,a.jsxs)(l.$,{variant:"link",size:"sm",onClick:()=>b.back(),className:"p-0 mb-2",children:[(0,a.jsx)(c.A,{className:"mr-0 h-4 w-4"}),"Go Back"]}),(0,a.jsxs)(n.Zp,{className:"w-full",children:[(0,a.jsx)(n.aR,{className:"p-6 pb-0",children:(0,a.jsx)(n.ZB,{className:"text-3xl font-bold",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:s.title}),(0,a.jsxs)(g(),{href:"/profile/".concat(s.owner.uid),className:"flex items-center gap-2 no-underline",children:[(0,a.jsx)("div",{className:"relative w-10 h-10 rounded-full overflow-hidden",children:(0,a.jsx)("img",{src:s.owner.imageUrl||"https://res.cloudinary.com/drmmom6jz/image/upload/v1746027479/Screenshot_from_2025-04-30_16-37-48_g58zzn.png",alt:"Profile",className:"object-cover w-full h-full"})}),(0,a.jsx)("span",{children:s.owner.fullName})]},s.owner.uid)]})})}),(0,a.jsxs)(n.Wu,{className:"p-6 pt-2 space-y-4",children:[(0,a.jsx)("div",{className:"grid gap-2",children:F?(0,a.jsxs)("div",{className:"grid w-full items-center gap-1.5",children:[(0,a.jsx)(j.J,{htmlFor:"title",children:"Title"}),(0,a.jsx)(m.p,{id:"title",name:"title",value:E.title,onChange:L}),(0,a.jsx)(j.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(p.T,{id:"description",name:"description",value:E.description,onChange:L}),(0,a.jsx)(j.J,{htmlFor:"location",children:"Location"}),(0,a.jsx)(m.p,{id:"location",name:"location",value:E.location,onChange:L}),(0,a.jsx)(j.J,{htmlFor:"budget",children:"Budget"}),(0,a.jsx)(m.p,{id:"budget",type:"number",name:"budget",value:E.budget,onChange:L}),(0,a.jsx)(j.J,{htmlFor:"category",children:"Category"}),(0,a.jsxs)(v.l6,{onValueChange:e=>M({...E,category:e}),children:[(0,a.jsx)(v.bq,{className:"w-full",children:(0,a.jsx)(v.yv,{placeholder:"Select a category"})}),(0,a.jsxs)(v.gC,{children:[(0,a.jsx)(v.eb,{value:"delivery",children:"Delivery"}),(0,a.jsx)(v.eb,{value:"cleaning",children:"Cleaning"}),(0,a.jsx)(v.eb,{value:"handyman",children:"Handyman"}),(0,a.jsx)(v.eb,{value:"other",children:"Other"})]})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-gray-600",children:s.description}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Location:"}),(0,a.jsx)("span",{className:"text-gray-600",children:s.location})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Budget:"}),(0,a.jsxs)("span",{className:"text-gray-600",children:["$",s.budget]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Category:"}),(0,a.jsx)("span",{className:"text-gray-600",children:s.category})]})]})}),F&&(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(l.$,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),(0,a.jsx)(l.$,{onClick:B,children:"Save"})]}),s.userId!==N&&(0,a.jsxs)(y.lG,{children:[(0,a.jsx)(y.zM,{asChild:!0,children:(0,a.jsxs)(l.$,{className:"w-full ".concat(A),children:[S&&(null==q?void 0:q.status)==="pending"&&"Pending",S&&(null==q?void 0:q.status)==="accepted"&&"Accepted",S&&(null==q?void 0:q.status)==="rejected"&&"Rejected",(!S||(null==q?void 0:q.status)==="canceled")&&"Request"]})}),(0,a.jsxs)(y.Cf,{children:[(0,a.jsxs)(y.c7,{children:[(0,a.jsx)(y.L3,{children:"Request Task"}),(0,a.jsx)(y.rr,{children:S&&(null==q?void 0:q.status)!=="canceled"?(null==q?void 0:q.status)==="pending"?"You have sent a request to ".concat(s.owner.fullName,". do you want to cancel the request?"):"You have already sent a request to ".concat(s.owner.fullName,"."):"Send a request with a message to do this task for ".concat(s.owner.fullName,".")})]}),S&&(null==q?void 0:q.status)!=="canceled"?(null==q?void 0:q.status)==="pending"&&(0,a.jsx)(l.$,{onClick:_,className:"flex items-center bg-gray-200 text-gray-500 hover:bg-gray-300",children:"Cancel request"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.T,{id:"request-msg",name:"request-msg",onChange:e=>C(e.target.value)}),(0,a.jsx)(l.$,{onClick:$,className:"flex items-center",children:"Request"})]})]})]})]}),(0,a.jsxs)(n.Wu,{className:"p-6 pt-2 flex justify-between gap-4",children:[z&&!F&&(0,a.jsxs)(l.$,{onClick:()=>R(!0),variant:"outline",className:"flex items-center w-full",children:[(0,a.jsx)(u,{className:"mr-2 h-4 w-4"}),"Edit"]}),z&&!F&&(0,a.jsxs)(y.lG,{children:[(0,a.jsx)(y.zM,{asChild:!0,children:(0,a.jsx)(l.$,{variant:"destructive",className:"w-full",children:"Delete"})}),(0,a.jsxs)(y.Cf,{children:[(0,a.jsxs)(y.c7,{children:[(0,a.jsx)(y.L3,{children:"Are you sure you want to delete this task?"}),(0,a.jsx)(y.rr,{children:"This action cannot be undone. This will permanently remove the task from the database."})]}),(0,a.jsxs)(l.$,{onClick:J,variant:"destructive",className:"flex items-center",children:[(0,a.jsx)(h,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})]})},o)})},b=()=>{let{id:e}=(0,f.useParams)(),{firestorePromises:s}=(0,i.useAuth)(),{app:t}=(0,i.useFirebase)(),[l,n]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{if(!e||!t)return;let{getFirestore:a}=await s,l=a(t),r=(0,d.doc)(l,"tasks",e),i=await (0,d.getDoc)(r),c=i.data(),o=(0,d.doc)(l,"users",null==c?void 0:c.userId),u=await (0,d.getDoc)(o);i.exists()&&n({id:i.id,...c,owner:u.data()})})()},[e,t,s]),(0,a.jsx)("div",{children:l&&l.id?(0,a.jsx)(w,{task:l}):(0,a.jsx)("p",{children:"Task not found"})})}},8539:(e,s,t)=>{"use strict";t.d(s,{T:()=>r});var a=t(5155),l=t(2115),n=t(9434);let r=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...l})});r.displayName="Textarea"}},e=>{var s=s=>e(e.s=s);e.O(0,[992,192,984,874,149,197,706,188,441,684,358],()=>s(3359)),_N_E=e.O()}]);